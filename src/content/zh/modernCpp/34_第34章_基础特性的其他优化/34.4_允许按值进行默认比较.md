# 34.4 允许按值进行默认比较（C++20）

以下代码在C++20标准之前是无法编译成功的：

```lisp
struct C {
    int i;
    friend bool operator == (C, C) = default;
};
```

因为在C++20之前的标准中，类的默认比较规则要求类c可以有一个参数为const C&的非静态成员函数，或者有两个参数为const C&的友元函数。而C++20标准对这一条规则做了适度的放宽，它规定类的默认比较运算符函数可以是一个参数为const C&的非静态成员函数，或是两个参数为const C&或C的友元函数。这里的区别在于允许按值进行默认比较，于是上面的代码可以顺利地通过编译。但是请注意，下面这两种情况依旧是标准不允许的：

```txt
struct A {
    friend bool operator == (A, const A&) = default;
};
```

在上面的代码中，A因为混用const A&和A而不符合标准要求，所以编译失败。另外，标准并没有放宽默认比较中对于非静态成员函数的要求，B依然无法通过编译。


# 17.3 begin和end函数不必返回相同类型

在C++11标准中基于范围的for循环相当于以下伪代码:

```txt
{ auto && _range  $=$  range_expression; for (auto begin  $=$  begin_expr, end  $=$  end_expr; begin  $! =$  end; ++begin){ rangedeclaration  $=$  \*begin; loop_statement }   
}
```

其中begin_expr和end_expr可能是__range.begin()和__range.end(),或者是begin(_range)和end(_range)。当

然，如果__range是一个数组指针，那么还可能是__range和__range+__count（其中__count是数组元素个数）。这段伪代码有一个特点，它要求begin_expr和end_expr返回的必须是同类型的对象。但实际上这种约束完全没有必要，只要__begin != __end能返回一个有效的布尔值即可，所以C++17标准对基于范围的for循环的实现进行了改进，伪代码如下：

```txt
{ auto&&_range  $\equiv$  range_expression; autobegin  $\equiv$  begin_expr; auto_end  $\equiv$  end_expr; for(；begin！  $= _ { \text{一} }$  end;++begin）{ range.Declaration  $\equiv$  \*begin; loop_statement }   
1
```

可以看到，以上伪代码将__begin和__end分离到两条不同的语句，不再要求它们是相同类型。

